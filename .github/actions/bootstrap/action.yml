name: Bootstrap
on:
  workflow_call:

env:
  DEVELOPER_DIR: /Applications/Xcode_14.0.app/Contents/Developer

runs:
  using: composite
  steps:
    - uses: ruby/setup-ruby@v1
      with:
        ruby-version: .ruby-version
        bundler-cache: true

    - name: Cache Mint
      id: cache-mint
      uses: actions/cache@v3
      with:
        path: ~/.mint
        key: ${{ runner.os }}-mint-v1-${{ hashFiles('Mintfile') }}

    - name: Bootstrap
      env:
        HOMEBREW_NO_AUTO_UPDATE: 1
        HOMEBREW_NO_INSTALL_CLEANUP: 1
      run: |
        make setup # NOTE: - CI won't run bundle install
        make tools

# name: "Publish to Docker"
# description: "Pushes built artifacts to Docker"

# inputs:
#   registry_username:
#     description: “Username for image registry”
#     required: true
#   registry_password:
#     description: “Password for image registry”
#     required: true

# runs:
#   using: "composite"
#   steps:
#       - uses: docker/setup-buildx-action@v1

#       - uses: docker/login-action@v1
#         with:
#           username: ${{inputs.registry_username}}
#           password: ${{inputs.registry_password}}

#       - uses: docker/build-push-action@v2
#         with:
#           context: .
#           push: true
#           tags: user/app:latest
